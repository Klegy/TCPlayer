<applib:ModernWindow
    x:Class="TCPlayer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:applib="http://github.com/webmaster442/AppLib/WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="clr-namespace:TCPlayer.Controls"
    xmlns:medialib="clr-namespace:TCPlayer.MediaLibary"
    xmlns:props="clr-namespace:TCPlayer.Properties"
    x:Name="MainWin"
    Title="TC Player"
    Width="1024"
    Height="600"
    Left="{Binding Source={x:Static props:Settings.Default}, Path=Left, Mode=TwoWay}"
    Top="{Binding Source={x:Static props:Settings.Default}, Path=Top, Mode=TwoWay}"
    Topmost="{Binding Source={x:Static props:Settings.Default}, Path=TopMost, Mode=TwoWay}"
    WindowIsTransparent="{Binding Source={x:Static props:Settings.Default}, Path=OpacityState, Mode=TwoWay}"
    AllowDrop="True"
    Drop="MainWin_Drop"
    Closing="MainWin_Closing"
    PreviewKeyDown="MainWin_PreviewKeyDown"
    Icon="icon.png"
    mc:Ignorable="d">
    <Window.TaskbarItemInfo>
        <TaskbarItemInfo
            x:Name="Taskbar"
            ProgressState="None"
            ProgressValue="0"
            ThumbnailClipMargin="0,30,485,140">
            <TaskbarItemInfo.ThumbButtonInfos>
                <ThumbButtonInfo
                    Description="{applib:Translate PlayerTab_ButtonPlayPause}"
                    CommandParameter="Play/Pause"
                    Click="ThumbButtonInfo_Click"
                    ImageSource="Style/taskbar-play-pause.png" />
                <ThumbButtonInfo
                    CommandParameter="Previous track"
                    Description="{applib:Translate PlayerTab_ButtonPrevousTrack}"
                    Click="ThumbButtonInfo_Click"
                    ImageSource="Style/taskbar-skip-previous.png" />
                <ThumbButtonInfo
                    CommandParameter="Next track"
                    Description="{applib:Translate PlayerTab_ButtonNextTrack}"
                    Click="ThumbButtonInfo_Click"
                    ImageSource="Style/taskbar-skip-next.png" />
                <ThumbButtonInfo
                    CommandParameter="Mute/UnMute"
                    Description="{applib:Translate PlayerTab_ButtonMuteUnmute}"
                    Click="ThumbButtonInfo_Click"
                    ImageSource="Style/taskbar-volume-off.png" />
            </TaskbarItemInfo.ThumbButtonInfos>
        </TaskbarItemInfo>
    </Window.TaskbarItemInfo>
    <Grid
        x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <controls:Overlay
            x:Name="Overlay"
            Panel.ZIndex="100"
            ContentWidth="{Binding ElementName=MainGrid, Path=ActualWidth, Converter={applib:OperationConverter}, ConverterParameter=* 0.70}"
            ContentHeight="{Binding ElementName=MainGrid, Path=ActualHeight, Converter={applib:OperationConverter}, ConverterParameter=* 0.50}"
            Grid.RowSpan="30"
            Grid.ColumnSpan="33"/>

        <Grid
            Grid.Row="0"
            Height="30"
            Background="{StaticResource MenuBackground}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Menu
                Grid.Column="0"
                Margin="5,0"
                VerticalAlignment="Center">
                <MenuItem Header="[ Player ]">
                    <MenuItem Header="Change output device ..." Command="{Binding PlayerChangeOutputCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_volume_up" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Settings ..." Command="{Binding PlayerSettingsCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_cogs" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="About..." Command="{Binding PlayerAboutCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_info" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator Style="{StaticResource sp}" />
                    <MenuItem Header="Exit" Command="{Binding PlayerExitCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_sign_out" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <MenuItem x:Name="ChapterMenu" Header="{applib:Translate PlayerTab_ButtonChapters}" />
                <MenuItem Header="[ PlayList ]">
                    <MenuItem Header="Save List ..." Command="{Binding PlaylistSaveCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_floppy_o" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>

                    <Separator Style="{StaticResource sp}" />

                    <MenuItem Header="Add Directory ..." Command="{Binding PlaylistAddDirectoryCommnad}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_folder_open" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Add Files ..." Command="{Binding PlaylistAddFileCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_file" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Add Playlist ...." Command="{Binding PlaylistAddPlaylistCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_list" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Add URL ..." Command="{Binding PlaylistAddUrlCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_link" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>

                    <MenuItem Header="Disc ..." SubmenuOpened="MenuItem_SubmenuOpened">
                        <MenuItem Header="{applib:Translate Playlist_NoDiscsFound}" />
                    </MenuItem>

                    <Separator Style="{StaticResource sp}" />

                    <MenuItem Header="Sort: Ascending" Command="{Binding PlaylistSortAscCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_sort_asc" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Sort: Descending" Command="{Binding PlaylistSortDescCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_sort_desc" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Sort: Random order" Command="{Binding PlaylistSortRandomCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_random" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Sort: Remove Duplicates" Command="{Binding PlaylistSortDisticntCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_diamond" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>

                    <Separator Style="{StaticResource sp}" />

                    <MenuItem Header="Clear List" Command="{Binding PlaylistClearCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_trash" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>

                    <MenuItem Header="Delete Selected" Command="{Binding PlaylistDeleteCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_remove" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>

                <MenuItem Header="[ File Explorer ]">
                    <MenuItem Command="{Binding FileExplorerNavigateHomeCommand}" Header="Navigate to start">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_home" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator Style="{StaticResource sp}" />
                    <MenuItem
                        IsEnabled="{Binding ElementName=FileExplorer, Path=HasFilesSelected}"
                        Command="{Binding FileExplorerPlaySelectedCommand}"
                        Header="Play selected">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_play" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        IsEnabled="{Binding ElementName=FileExplorer, Path=HasFilesSelected}"
                        Command="{Binding FileExplorerAddToPlaylistCommand}"
                        Header="Add Selected to Playlist">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_play" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>

                <MenuItem Header="[ Media Libary ]">
                    <MenuItem Header="Add Directory ..." Command="{Binding MediaViewModel.MenuAddFolderCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_folder_open" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Add Files ..." Command="{Binding MediaViewModel.MenuAddFilesCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_file" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator Style="{StaticResource sp}" />
                    <MenuItem Header="Send selection to playlist" Command="{Binding MediaViewModel.MenuSendToPlaylistCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_list" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator Style="{StaticResource sp}" />
                    <MenuItem Header="Create Query ..." Command="{Binding MediaViewModel.MenuCreateQueryCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_search" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator Style="{StaticResource sp}" />
                    <MenuItem Header="Backup Database ..." Command="{Binding MediaViewModel.MenuBackupDbCommand}">
                        <MenuItem.Icon>
                            <applib:ImageAwesome Icon="fa_save" Style="{StaticResource Menu}" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>

            </Menu>
            <applib:DateTimeTextBlock
                Grid.Column="1"
                Margin="10,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                Foreground="{StaticResource MenuForeground}"
                FontSize="14" />
        </Grid>

        <StackPanel
            x:Name="ButtonBar"
            Grid.Row="1"
            Margin="5,5,0,0"
            HorizontalAlignment="Left"
            Orientation="Horizontal">

            <StackPanel Margin="10,0" VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="TbFullTime" Text="00:00:00" />
                    <TextBlock Text=" / " />
                    <TextBlock x:Name="TbCurrTime" Text="00:00:00" />
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{applib:Translate MainWin_ListLabel}" />
                    <TextBlock Text="{Binding CorrectedPlayListIndex}" />
                    <TextBlock Text=" / " />
                    <TextBlock Text="{Binding PlayList.Count}" />
                </StackPanel>
            </StackPanel>

            <applib:FaImageButton
                x:Name="BtnOpen"
                Margin="5,0"
                Icon="fa_eject"
                Click="DoAction"
                Style="{StaticResource PlayImgButtons}"
                ToolTip="{applib:Translate PlayerTab_ButtonOpen}" />
            <Button
                x:Name="BtnPlayPause"
                Style="{StaticResource PlayButtons}"
                ToolTip="{applib:Translate PlayerTab_ButtonPlayPause}"
                Click="DoAction"
                Content="{StaticResource IconPlayPause}" />
            <applib:FaImageButton
                x:Name="BtnStop"
                Margin="5,0"
                Style="{StaticResource PlayImgButtons}"
                Icon="fa_stop"
                ToolTip="{applib:Translate PlayerTab_ButtonStop}"
                Click="DoAction" />
            <applib:FaImageButton
                x:Name="BtnSeekBack"
                Style="{StaticResource PlayImgButtons}"
                Icon="fa_backward"
                ToolTip="{applib:Translate PlayerTab_ButtonSeekBack}"
                Click="DoAction" />
            <applib:FaImageButton
                x:Name="BtnSeekFwd"
                Margin="5,0"
                Style="{StaticResource PlayImgButtons}"
                Icon="fa_forward"
                ToolTip="{applib:Translate PlayerTab_ButtonSeekForward}"
                Click="DoAction" />
            <applib:FaImageButton
                x:Name="BtnPrevTrack"
                Style="{StaticResource PlayImgButtons}"
                Icon="fa_fast_backward"
                ToolTip="{applib:Translate PlayerTab_ButtonPrevousTrack}"
                Click="DoAction" />
            <applib:FaImageButton
                x:Name="BtnNextTrack"
                Margin="5,0"
                Style="{StaticResource PlayImgButtons}"
                Icon="fa_fast_forward"
                ToolTip="{applib:Translate PlayerTab_ButtonNextTrack}"
                Click="DoAction" />
            <ToggleButton
                x:Name="BtnMute"
                ToolTip="{applib:Translate PlayerTab_ButtonMuteUnmute}"
                Click="BtnMute_Click"
                Content="{StaticResource IconMute}" />
            <Slider
                x:Name="VolSlider"
                Grid.Column="1"
                Width="180"
                Margin="15,0,0,0"
                VerticalAlignment="Center"
                Minimum="0"
                Maximum="1"
                ValueChanged="VolSlider_ValueChanged"
                Value="1">
                <Slider.ToolTip>
                    <ToolTip Content="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.Value}" ContentStringFormat="{applib:Translate PlayerTab_VolumeSliderText}" />
                </Slider.ToolTip>
            </Slider>

            <StackPanel Margin="30,0,0,0" VerticalAlignment="Center">
                <ProgressBar
                    x:Name="VuR"
                    Width="180"
                    Height="8"
                    Margin="0,0,0,2"
                    Maximum="32768" />
                <ProgressBar
                    x:Name="VuL"
                    Width="180"
                    Height="8"
                    Maximum="32768" />
            </StackPanel>

        </StackPanel>

        <Slider
            x:Name="SeekSlider"
            Grid.Row="2"
            Margin="10,10"
            IsMoveToPointEnabled="True"
            Thumb.DragCompleted="SeekSlider_DragCompleted"
            Thumb.DragStarted="SeekSlider_DragStarted"
            ValueChanged="SeekSlider_ValueChanged" />

        <applib:AnimatedTabControl
            x:Name="MainView"
            Grid.Row="3"
            Grid.RowSpan="2"
            TabStripPlacement="Top">
            <TabItem Header="[ Playing ]">
                <controls:NowPlaying x:Name="SongDat" />
            </TabItem>
            <TabItem Header="{applib:Translate MainWin_PlaylistTab}">
                <ListBox
                    x:Name="PlaylistView"
                    ItemsSource="{Binding PlayList}"
                    MouseDoubleClick="PlayList_ItemDoubleClcik" />
            </TabItem>
            <TabItem Header="[ File Browser ]">
                <applib:FileExplorer
                    x:Name="FileExplorer"/>
            </TabItem>
            <TabItem Header="[ Media Libary ]">
                <medialib:MediaLibary DataContext="{Binding MediaViewModel}" />
            </TabItem>
            <TabItem Header="{applib:Translate MainWin_RadioTab}">
                <controls:RadioStations x:Name="RadioStations" ItemDoubleClcik="RadioStations_ItemDoubleClcik" />
            </TabItem>
        </applib:AnimatedTabControl>
    </Grid>
</applib:ModernWindow>
